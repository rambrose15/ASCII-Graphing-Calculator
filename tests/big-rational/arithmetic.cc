#include "doctest.h"
#include "numeric/big_rational.h"

TEST_CASE("integer addition") {
  BigRational a("111111111111");
  BigRational b("999999999");
  BigRational c("-123456789100");
  BigRational d("-98765432100");
  CHECK((a+b).getDecimalForm(0) == "112111111110");
  CHECK((c+d).getDecimalForm(0) == "-222222221200");
  CHECK((a+c).getDecimalForm(0) == "-12345677989");
}

TEST_CASE("decimal addition") {
  BigRational a("1.012345678999");
  BigRational b(".9898989898989");
  BigRational c("-.9");
  BigRational d("-0.000000000001");
  CHECK((a+b).getDecimalForm(13) == "2.0022446688979");
  CHECK((c+d).getDecimalForm(12) == "-0.900000000001");
  CHECK((a+c).getDecimalForm(12) == "0.112345678999");
}

TEST_CASE("integer subtraction") {
  BigRational a("111111111111");
  BigRational b("111111111199");
  BigRational c("-123456789100");
  BigRational d("-98765432100");
  CHECK((a-b).getDecimalForm(0) == "-88");
  CHECK((c-d).getDecimalForm(0) == "-24691357000");
  CHECK((a-c).getDecimalForm(0) == "234567900211");
}

TEST_CASE("decimal subtraction") {
  BigRational a("1.012345678999");
  BigRational b(".9898989898989");
  BigRational c("-.9");
  BigRational d("-0.000000000001");
  CHECK((a-b).getDecimalForm(13) == "0.0224466891001");
  CHECK((c-d).getDecimalForm(11) == "-0.89999999999");
  CHECK((a-c).getDecimalForm(12) == "1.912345678999");
}

TEST_CASE("multiplication") {
  BigRational a("10203040506070809.123456789");
  BigRational b("998877665544332211.987654321");
  BigRational c("-46128171.63549828374");
  BigRational d("-2435.903497209347520");
  CHECK((a*b).getDecimalForm(18) == "10191589282158271749568373620606752.282078799112635269");
  CHECK((c*d).getDecimalForm(25) == "112363774606.7832970337901484452253248");
  CHECK((a*c).getDecimalForm(20) == "-470647603667975551892875.12297284218555131086");
}

TEST_CASE("division") {
  BigRational a("10203040506070809.123456789");
  BigRational b("998877665544332211.987654321");
  BigRational c("-46128171.63549828374");
  BigRational d("-2435.903497209347520");
  CHECK((a/b).getDecimalForm(200) == "0.01021450459652706844943934881949134061290127633380257986856131550918877875969174455938259712596684997396328397962920966803675445419446085245359328034412998875533174229194601553119921928594034960876638");
  CHECK((c/d).getDecimalForm(194) == "18936.78123470172741072782138497340857426128636533242099426562122516405992714601470976114007468333854647462181051055536993291048240646399635519022796236491738483852228341341790006989912700008689675622");
  CHECK((a/c).getDecimalForm(190) == "-221188920.8766944070688351624281467876961474442657644188649796535862423714116745901807630079405760980656245350033426236245136951871074297844527630843570824603092382561585287772303930434762832956283214");
}
